class Solution(object):
    def lenLongestFibSubseq(self, A):
        """
        :type A: List[int]
        :rtype: int
        """
        dp = []
        for i in range(len(A)): dp.append(dict())
        AS = set(A)
        mref = 0
        for i in range(2,len(A)):
            #print 'i ',i
            for j in range(i-1, 0,-1):
                if A[j] < A[i] - A[j]: break
                #print '    j ',j
                if A[i] - A[j] in dp[j]:
                    #print '     Found ', A[i]-A[j] , ' in dp[',str(j),']=', dp[j]
                    n = dp[j][A[i]-A[j]]
                    dp[i].setdefault(A[j], n+1)
                    #print '     Match A[i] ',A[i], dp[i]
                    mref = max(mref, n+1)
                else:
                    if A[i] - A[j] in AS:
                        if A[i]-A[j] >= A[j]: continue
                        dp[i].setdefault(A[j],3)
                        #print '     Add A[i] ',A[i], dp[i]
                        mref = max(mref, 3)
        return mref

print Solution().lenLongestFibSubseq([1,2,3,4,5,6,7,8])
print Solution().lenLongestFibSubseq([1,3,7,11,12,14,18])
print Solution().lenLongestFibSubseq([1,2,3,4,6,7,8,11])
print Solution().lenLongestFibSubseq([2,5,6,7,8,10,12,17,24,41,65])
print Solution().lenLongestFibSubseq([1,4,6,7,18,30,31,41,42,43,47,54,58,59,60,61,62,63,64,68,75,80,85,88,92,98,100,114,116,122,128,135,143,147,153,158,174,182,185,192,209,213,214,218,258,288,307,317,320,330,341,356,361,416,462,492,499,512,544,554,565,579,674,750,799,816,832,874,895,921,940,1090,1212,1291,1315,1344,1418,1449,1486,1519,1764,1962,2090,2131,2176,2292,2344,2407,2459,2854,3174,3381,3446,3520,3710,3793,3893,3978,4618,5136,5471,5577,5696,6002,6300,7472,8310,8852,9023,9216,9712,10193,12090,13446,14600,14912,15714,19562,23623,24128,25426,31652,38223,39040,41140,51214,61846,63168,66566,82866,100069,102208,107706,134080,161915,165376,174272,216946,261984,267584,281978,351026,423899,432960,456250,567972,608815,685883,700544,738228,918998,951222,1109782,1133504,1194478,1486970,1565801,1795665,1932706,2044392,2330726,2405968,2559698,2873539,2905447,3127184,3892938,3911900,4567487,4692269,4701112,5059890,5786985,6298906,6323321,8759759,8859227,9582997,10191844,10759191,14592748,15236859,16490750,17258992,18995173,19917974,21937912,22028824,22631293,22923043,23705543,24370287,25284118,25502746,26591383,29298630,29488945,32915351,33901815,35336875,39966790,40429753,40782949,42034433,45414628,46229706,46601302,47420000,47681571,48712708,51740144,51900133,53357798,53936952,55381585,56679168,62266553,62550854,62963722,63046154,63643386,64022182,64397639,65576008,67384950,67406549,68209572,69134827,69490696,71157266,72933504,75596923,77608371,77731557,78763576,79161223,80046057,80220600,80738987,82950133,83036492,85394039,88295522,89218689,89439267,89703463,89977713,90142175,90310727,91154244,92643371,93022760,94275889,94637396,97590878,99996330,100115610,100947728,100959484,102786600,104307827,104600560,105312439,106184402,107289244,107299554,108121918,110287804,111943912,113020734,118056448,118109383,119656955,120090461,121628682,122285068,122635834,122814565,123820528,123864355,126023762,126657501,127449836,131134530,131732934,132083771,132146384,134937007,137719562,137980864,139086767,139493639,139743363,140618511,144929884,146441214,147480945,149350691,149424399,150585793,153201957,154086384,155007557,156621463,157024816,158364243,158752572,159175767,160549481,162880390,163112842,163606397,163686226,164428095,165950242,166223136,167470626,175100637,175326140,176238899,176770892,178919167,179126815,183318272,185832936,187712314,188178325,190517118,192417487,192737686,192750274,194213407,194323733,194848523,195249823,195602005,197903673,198571498,199793709,201993776,204199503,204786139,206758865,206846463,207262818,207853577,209067379,209079452,210218618,210341610,210634995,212145593,215220793,221171002,223040321,224662345,226506266,226886480,227089027,227967001,228757457,231405324,233311872,233500473,233538345,233768868,234534045,235672067,236123966,236604385,238846967,239494121,240641520,241692088,244191334,244855503,246777577,247940441,248669830,250469424,252723771,257336334,257437596,257865166,258450114,261694092,264323625,264943980,267103545,269763888,276087824,281736924,285745528,289457471,289768179,291431104,291689811,291905540,292332964,294617143,295829713,296799496,297155155,297671323,298088973,298852411,301195238,301873852,304024667,304520205,306147219,308096177,309074472,310005477,310295319,310441944,310856619,310897167,312098435,312128841,312766392,313100498,313685448,314204092,314447483,314453498,314671477,315246242,315422893,317303144,321244268,322346687,323223644,323950588,324876397,325878752,326125455,326895881,328020351,328531454,329857576,330737112,331590865,333622351,335083892,335806729,336261438,336642998,336701051,337174780,337417911,337449646,338715592,340253232,340559627,342741575,342772217,346475829,346592674,347919730,348217854,349033896,350703158,350842206,354602692,355478926,355720401,357319099,360199504,362725981,363861642,364051842,365750311,370527505,371150309,371356058,372304649,373341576,373819346,375951462,376074663,378180772,378181649,378614431,379377936,379385798,380029366,380565157,380919643,382057874,383222938,384089562,385412173,386064477,386371983,386588400,386702072,389162728,392214136,393042420,393561482,394013459,394733911,394913146,395278783,395545688,395842350,396833051,398442339,400239626,400937028,402048456,402735008,403043228,404835807,405864793,406054532,407093935,407435387,408537399,408621130,409689465,411281624,411541697,415007750,415692686,417354306,417569012,417900565,419418119,422219901,424983068,428120248,428510059,429014688,429242011,430521674,431553693,432259552,432784199,433987779,434441606,434665042,438168110,440538005,440623663,441675310,441886584,442927862,443749614,445063353,445068993,445367927,445989512,447202504,447650533,448189428,448240122,448560286,450150898,450855869,451734330,452238303,452708175,457301360,457564185,457716793,458242000,458523624,460524428,460626717,461349063,461531681,462213282,466218273,466644253,468246830,471146391,471809360,472462763,472790410,475226607,478206903,485113287,485832150,486690776,487515878,487613144,489455699,490313840,491002719,493294611,494016999,494880905,494898765,494979442,496573541,497091790,497855998,498483439,499907932,501940773,504966176,505262788,507085586,509106184,509769815,510254298,510716487,511215888,511234123,512867219,513721694,513767261,515110920,515629544,523553836,524044536,525050962,527218245,527369101,531490648,531912573,532219835,532238423,537116627,538484884,538827766,539245623,539267208,540372983,543502364,543785778,545858141,546812350,547100171,549500173,550177879,550337635,552492623,554519985,554784323,554943105,555152962,555287469,556411562,556717273,557836925,558746916,559376676,560813355,564403123,565745755,566555434,569846952,570218443,570765111,571254233,572356498,572727324,575273321,575395656,575862131,577243144,577270022,577721750,578675308,578832888,578904417,579902492,580246607,580381913,580823462,581202886,582608940,584061061,584663610,584874701,585863223,588545345,588775537,589961953,590292200,591176565,594775583,596098659,596205929,599092014,599243756,602473994,603276781,605124512,605326022,606246028,608759145,611130562,613543824,614577537,615449912,618152175,618429694,618601260,618919940,618954544,620904823,621174325,623471819,625190346,633293186,634846888,636568102,636844815,638070955,641252837,642685548,643098638,643529831,643630516,643635847,643792744,646123646,650849524,654534183,655438169,657285820,657390609,657960032,657965408,658570418,660506301,661865025,662450478,662841804,664901314,665880154,666674944,666697361,669366993,671810962,672861141,673381719,675690038,675986521,677425923,679438685,682227855,683300749,683717487,684422711,686072012,687713733,690729989,692161295,692397826,693880795,694152695,694235427,694305351,694992762,695433709,695968145,696326156,699499613,700799128,701566642,702693808,703535129,705298911,705341880,706309436,707501900,708700112,711881158,712025404,712181337,715799261,722252095,723290098,723607258,724956694,725460839,726200491,726603788,727935984,728438382,732488978,734811221,738004943,738785620,739109388,739559306,741843843,742157078,742768480,744121084,745035410,745999810,746754645,748275915,749319556,749341349,750890975,751068699,751737628,756083431,756684036,758360688,758711894,759055214,761260751,761303832,761431738,762694003,763351052,766882412,767196755,767406525,767827233,768809721,769853431,772753589,773382895,775000238,777204586,780345053,781397567,781990612,783280258,784182970,785972843,788735978,790269987,792014351,795087361,796149757,797047644,797553527,799212040,799787135,799893424,801463228,804646894,805407516,808070336,808128397,808323789,808363349,816007600,817704060,817800501,818553198,820097299,822916353,824818875,825098143,826105441,826427887,830276887,832727582,833044814,833133354,833421070,835572624,835696679,837331127,837403782,843590229,845564553,846615956,847096965,847860170,847874577,847894619,849011078,849835558,851346883,851350910,851363102,853194991,853748619,855187650,855473584,858038735,859054746,861310233,862541770,865551076,865652598,868502600,870970427,871892073,873206369,875328249,875406935,875850929,879251320,880210046,880915966,881828402,883067045,885193460,888320136,888776308,891538381,893757584,897796781,898307902,898661075,898944406,899288695,900138799,900970996,901038669,902442566,903359428,903659156,904058344,904218014,905460265,906007740,906241242,907208969,910508296,911603849,913223076,918940356,919434629,919824764,921756193,922958278,927314869,927829476,928218694,928872075,928995432,929550359,929794603,932331841,932905286,933560610,933601819,935865319,937790486,940693724,941838506,941991851,942839746,942975770,944842205,944918283,945314909,950131870,950371145,951509799,951884568,952535165,952667794,952837842,953589741,955490077,958542728,960647991,960829698,961440476,962364964,963953458,965217325,967061999,967091782,969007410,969388412,970975970,971313339,972250875,973660310,976891593,977110621,977291220,977445472,982231656,982397671,984529947,987274863,987744113,988484618,990639973,990664626,991743099,991924222,993351444,994984091,996098037,998299596,999824459])

