import itertools
import heapq
class Solution(object):
    def kSmallestPairs(self, nums1, nums2, k):
        #p = itertools.product(nums1, nums2)
        #ll = [(x+y, (x,y)) for x,y in p]
        #return [x[1] for x in heapq.nsmallest(k,ll)]
        return heapq.nsmallest(k,[(x, y) for x in nums1 for y in nums2],key=lambda x:(x[0]+x[1]))[:k]

    def kSmallestPairs1(self, n1, n2, k):
        """
        :type nums1: List[int]
        :type nums2: List[int]
        :type k: int
        :rtype: List[List[int]]
        """
        res = []
        l1 = len(n1)
        l2 = len(n2)
        if l1==0 or l2==0:
            return []
        i=0;j=0;
        (x,y) = (0,0)
        res.append((n1[x],n2[y]))
        k -= 1
        while k and i < l1 and j < l2:
            if y == l2-1:
                y = 0
                i +=1
            if x == l1-1:
                x = 0
                j +=1
            if y < l2-1 and x < l1-1:
                if (n1[i]+n2[y+1] < n1[x+1]+n2[j]):
                    y += 1
                    res.append((n1[i],n2[y]))
                else:
                    x += 1
                    res.append((n1[x],n2[j]))
            elif y < l2-1:    
                    y += 1
                    res.append((n1[i],n2[y]))
            elif x < l1-1:    
                    x += 1
                    res.append((n1[x],n2[j]))
            
            k -= 1

        return res

print Solution().kSmallestPairs([],[],3)
print Solution().kSmallestPairs([1,7,11],[2,4,6],3)
print Solution().kSmallestPairs([1,1,2],[1,2,3],2)
print Solution().kSmallestPairs([1,2],[3],3)
print Solution().kSmallestPairs([-3,-1,3,5],[-5,0,3,9,14],5)
print Solution().kSmallestPairs([-498632390,-498363355,-498023489,-497099502,-495119360,-493350488,-493205489,-491227876,-483626888,-483415788,-483395023,-482866628,-481656310,-481164544,-479566058,-476033095,-473892148,-467256155,-466120909,-465829335,-461928302,-460806292,-459300736,-457213831,-454640145,-453966245,-453075360,-452632401,-451370488,-449381843,-446633639,-446500004,-446037421,-441998110,-441409727,-439162721,-437064565,-428405597,-427354205,-426627456,-426484011,-425940955,-425190229,-424533376,-422472829,-420700367,-419755462,-417949232,-417455598,-408984688,-406582877,-405417825,-400343463,-400028392,-397401077,-396314987,-395963245,-389012260,-385137769,-384801963,-381592020,-378140476,-375454398,-375261106,-374717256,-371479100,-369344254,-368233068,-365619786,-360120610,-359921394,-357273799,-352353887,-351405316,-350049194,-346955478,-342226874,-336886663,-336538932,-336531916,-335090116,-334145228,-334096205,-333609402,-331762804,-331022148,-331002732,-330651913,-328806170,-322814874,-322649407,-314586227,-312227427,-309190843,-302783948,-302667051,-296505922,-294969150,-294204591,-294068362,-293270393,-291756476,-289937063,-289320777,-288694615,-288328740,-284676459,-280367749,-280157513,-278658672,-277557448,-274468672,-273818924,-270252709,-269123372,-263414637,-262056405,-261601106,-261248019,-260473480,-259207110,-258284672,-257114356,-253760282,-249936312,-249173253,-248167484,-247086285,-244606442,-244110502,-242283319,-242010680,-235410646,-232805939,-227624874,-226875427,-226162737,-224955768,-222491948,-220391354,-220254975,-216646581,-213921384,-213920645,-211124838,-209231588,-208535009,-208235850,-205723265,-202995313,-202608304,-198395017,-197055149,-192125688,-190613351,-189541042,-189043220,-188359364,-185641935,-184471093,-182487069,-182022295,-174935816,-174068101,-173502485,-173033491,-170965048,-170419489,-167604440,-166661119,-165429057,-164442976,-163552893,-160613724,-160241783,-159499743,-157845901,-156623631,-156501973,-154591589,-150221025,-149046577,-147968492,-147659892,-146993387,-145644989,-143088830,-142094077,-131360273,-131359481,-130590699,-129390798,-129337167,-128360854,-125427382,-125045851,-124424626,-121407997,-117847598,-116604696,-113502040,-111568009,-109227751,-107546956,-105985837,-105659206,-102981594,-102423135,-94075816,-93929706,-82982025,-79852607,-79290948,-76605795,-73890046,-71021860,-69852932,-68586498,-68368497,-66420028,-66134406,-65899736,-65105562,-65083043,-51372744,-50561938,-49265857,-48941882,-48822145,-46982152,-41777542,-40596432,-40528515,-38142479,-34253100,-33304187,-30316836,-29459212,-28736109,-27909567,-27570726,-23881421,-20530273,-20103535,-18842898,-9209948,-8407939,-6589155,-6199646,-2053599,-1651604,1965453,5349098,8338492,9238909,9606762,10476112,11684050,12072022,15599692,17932949,20634594,31535617,34316132,34838185,38631547,38773626,42275652,43077122,49388846,49567088,49948914,55154177,55587373,55846559,57341215,57351340,58916274,59785199,60396084,61113029,62416961,62642057,65515048,65980592,66216733,67412464,68393649,73145148,73360674,73788009,75621875,79094124,81455437,88267286,88295551,89857788,94606425,98336284,98615684,98870546,99047203,100232790,104505736,105157915,105631966,107533366,108083509,111176332,114617715,115776055,117308525,119158216,119382002,120716823,123721391,124540150,128589778,128809970,129213661,134375756,137594346,138032322,139108709,141344449,142973842,146220201,147796151,150690911,152173835,158837999,159315426,161014853,161825258,162415093,163765130,165407226,165805510,166939769,172561381,175608021,176827080,180576038,181932921,182198438,184883016,185379156,189131631,191556927,192345002,195083206,199836144,204473396,208200590,208888030,211888287,212532063,213037384,213460462,213764332,215678868,217147053,217230822,217359089,220988648,221529377,223970687,224122993,226145204,229571301,230392052,233383179,234657221,236838545,237231458,239928345,242266651,244262065,246088698,247769770,248627875,251255521,253411159,257865591,265835534,266173639,270535845,271968821,273244240,274461733,275329585,276581560,277698209,279437813,283448128,287406226,287828639,289973132,290221472,290718004,291167680,291762316,294020541,294881941,297802510,305427078,313251499,319409223,319557339,319761013,322057738,327954464,329411290,331790835,331985210,334286890,343906319,346920936,347970037,353970905,359083323,363018426,364105209,367014945,367114023,370428996,371051174,371154683,371872751,372662009,373499116,376525330,382057847,382373128,382846717,383083610,388448661,390177297,391230639,392422855,394537080,396178070,396280526,400408284,400980316,401091996,401748083,402503291,403895671,404999080,410071340,412615049,412619972,414229916,416043023,416865741,418836183,421482771,421743067,422784289,424984023,425515595,427641335,428069867,430252983,431425782,433012610,434144329,435778634,436316718,439093806,442751402,443111079,444988900,446290652,447714396,448186311,448675517,451559228,453000969,453976650,455761021,456837834,461360881,461675245,462132064,463169898,466186067,467184063,468722712,477252332,478420690,484716662,484793531,485095410,490930452,496341002,496648838,497383746,498143041], [-498670499,-492068180,-491040251,-489783563,-488905091,-488759797,-479456729,-478091827,-474955191,-473567614,-472160433,-466740961,-464378811,-463638980,-461923846,-461672092,-461372369,-460459468,-452415238,-451480382,-450808293,-439987821,-438576080,-434222336,-433380014,-433317263,-430724976,-430007712,-426493934,-419135680,-418744852,-418520525,-417242107,-412398138,-405489350,-403800297,-402300618,-401512451,-400926390,-400109003,-393885877,-389168078,-382188820,-381516529,-376840431,-376341074,-376173647,-375540297,-375282814,-374282073,-373377115,-366095994,-365985627,-365152592,-365077417,-364715770,-364242290,-363332153,-362415407,-361193816,-359161598,-357070956,-356044671,-353405312,-351539661,-344355981,-342937860,-338234951,-335062244,-334962748,-334000145,-333337756,-332702836,-328204106,-325454191,-324667789,-321719654,-318055328,-316821833,-315260569,-312769683,-311778417,-311209172,-310682743,-306937202,-305325600,-305325180,-304597756,-304111173,-298512609,-296381582,-292274849,-291627156,-289053093,-289007423,-287545913,-285184759,-283027238,-277629359,-276984178,-271623024,-264891082,-263572613,-263327844,-262344338,-261006697,-260149303,-257860410,-257840739,-255367811,-255096968,-254413418,-250556091,-250319329,-249446596,-242439385,-242171374,-242030421,-241294281,-236043933,-232269859,-232225295,-228703619,-228241905,-222928629,-222452843,-222402415,-221053144,-218850142,-218071729,-213909241,-212504030,-206867741,-206071909,-204757234,-200064150,-196943239,-195633093,-194227855,-193502690,-182024998,-181486622,-174073393,-172432896,-171239918,-168937704,-167807891,-167773962,-166005138,-165592965,-163756771,-162531292,-159984417,-159663204,-159418591,-158890077,-158645100,-156832897,-156358382,-149384232,-143530304,-141329756,-140903774,-138606321,-136070027,-135642913,-134103322,-130113132,-124391395,-124030245,-123502606,-118823649,-118594653,-116421648,-112898951,-111311782,-109550446,-108827537,-108687892,-108404469,-107847374,-106861692,-106770805,-105852097,-104992473,-100373476,-99445291,-98768396,-97615771,-97116045,-92788697,-91660742,-91146287,-90498756,-84399146,-84230272,-83419065,-82926996,-80279806,-74402552,-69367334,-69095696,-68656090,-67106740,-66317876,-59726578,-56097516,-54586314,-54106600,-51931062,-49707049,-48043051,-47045071,-44943208,-43583312,-41751297,-37972675,-35522429,-35147487,-35092129,-34908068,-30043164,-29433322,-27081164,-26033584,-19385636,-16412524,-11570191,-11550323,-5859025,-1889048,-1180673,136423,512126,563951,3862031,6006194,6395680,7504554,7519986,7936796,10332038,10434148,13796937,17109805,17187029,18542420,19502233,24075977,26683123,32109432,33632031,35132822,42534636,45154232,49674826,54293234,55552196,59027687,61911070,65561076,71213880,73620361,74510986,76127712,78564179,78785376,79614463,80282278,85623855,85632956,86294077,89476241,89699758,89918741,90738917,90824290,91426795,92212110,93135366,94529492,95423020,96283473,99056650,101922037,102299867,102958983,107818346,107889251,109828907,111687011,113224235,117958650,118114860,118250489,118898725,119037698,125490048,125780118,127094859,131512538,131857323,132566799,135199597,136223134,136243263,136771885,137135901,137479779,140786217,142614145,143006525,144384714,144947833,148255249,148346653,149162234,160657903,162638111,165232454,167621989,171450575,172771224,173704152,174607540,178329769,178640936,180957731,181017554,181423399,182629758,182971534,183927350,189151380,192249066,195216444,202991556,203562724,205430163,207381725,207783714,208574874,212099298,213832607,216161949,218237342,224454813,226781013,234374052,236627403,237460907,237698308,237883805,240102756,243986764,244319065,245555248,249495433,249936108,251246294,254587598,256829868,258277215,258346075,258355956,259018510,261851642,262456642,263330499,263511289,263818623,264343057,271127152,271711390,271930830,281564044,283103569,284393317,284623509,285817110,286193837,287667185,290208343,290542831,294955991,295599837,295640818,296587349,298653475,298834905,299967063,300001859,301051705,302311777,302813745,303218243,305911403,306377227,306954032,307071016,309986471,313120915,313884757,316525663,317360913,317653476,319418569,320558867,320746953,321359679,322066555,329810019,332226053,336156858,337338780,342370170,343021246,345343852,346198181,348360716,354437369,355336566,357181219,358879757,360450596,360517684,362273818,362752932,363072095,364469489,370712455,374502940,374599875,378995447,379925674,381177839,385359524,385784608,386419216,387402980,392210707,400009937,402786178,403711677,406618104,408327981,411742370,415160066,417041976,417228809,419551468,420108725,420999870,424130737,425768083,426553634,426783039,427129391,427773585,431179751,433311248,433385101,436239963,436894479,437478964,438579694,438587029,438748086,445229059,446146048,451279595,452736581,454687679,460991446,463557332,464193091,464387361,464749422,465211129,465328453,468502762,471840243,474204530,474262451,474947262,477680628,478217450,482559933,482963993,483091642,485637030,486388319,486811817,487617967,488160745,488197079,488751675,495202785,496933035,498670937],1000)
