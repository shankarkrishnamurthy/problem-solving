import heapq
class Solution(object):
    def minRefuelStops(self, target, startFuel, stations):
        print stations[:10]
        cnt, stations = 0, stations + [[target, 1]]
        tank, pq = startFuel, []
        if tank >= target: return 0
        elif len(stations) == 1: return -1
        for loc, gas in stations:
            while pq and tank < loc:
                mgas = -heapq.heappop(pq)
                tank += mgas
                cnt += 1
                print 'Filling Gas', mgas

            if tank < loc: return -1

            heapq.heappush(pq, -gas)
            
        return cnt
        

print Solution().minRefuelStops(1000, 299, [[13,21],[26,115],[100,47],[225,99],[299,141],[444,198],[608,190],[636,157],[647,255],[841,123]])
"""
print Solution().minRefuelStops(12,2,[[1,5],[2,6],[3,1],[4,1],[5,5],[6,6],[7,1],[8,1],[9,5],[10,6],[11,1]])
print Solution().minRefuelStops(1000000, 53667, [[6950,13028],[21145,25000],[38690,6304],[54352,42300],[56808,45976],[63983,37886],[68419,15751],[69504,8075],[85043,32434],[92914,50646],[109806,43101],[112920,7430],[116008,35223],[121846,46938],[128528,48626],[128560,49460],[135306,1996],[151134,26992],[157586,52788],[166585,44818],[167892,13581],[202994,11028],[217878,18871],[241339,51351],[248208,38733],[257762,32253],[277792,36820],[288531,19642],[331194,18080],[348898,35356],[349346,4671],[359199,17610],[360009,5527],[368757,14195],[396664,14932],[401524,49201],[402539,35084],[422674,5352],[427795,14717],[431106,42724],[431917,46730],[437958,45353],[458031,9710],[467378,39191],[488467,49031],[495827,34298],[501568,35856],[504829,5089],[511736,30952],[516011,8269],[516355,51173],[519876,32562],[528434,18530],[561784,13822],[565838,38935],[574928,24104],[582225,5169],[593508,27144],[603060,31587],[613347,46986],[621815,47051],[641640,3362],[654360,37738],[676653,41273],[686787,13056],[695695,21872],[700010,25196],[721310,32491],[724872,26252],[725214,42539],[750190,15189],[765068,3418],[766642,23799],[769842,20742],[770378,44127],[777325,16075],[783687,15299],[783886,44121],[820968,6557],[822189,1196],[822795,49842],[824231,52596],[848150,39409],[854444,25292],[878221,22784],[889948,21445],[893844,17898],[895155,33036],[904112,40321],[911401,49930],[913887,9344],[929823,38731],[939245,45498],[952152,45798],[958422,53539],[979783,10569],[985338,5294],[991430,21666],[991970,35896],[996672,36853]])
print Solution().minRefuelStops(1000000, 13114, [[2047,11455],[3884,13061],[4654,8258],[5454,8325],[6368,8970],[7864,942],[11788,8010],[14421,6310],[17507,12441],[21218,8443],[21275,4166],[24725,12905],[25285,866],[25988,7423],[30259,7431],[30268,12423],[33822,7881],[35249,5151],[37623,8992],[37684,9151],[37949,4002],[38665,2998],[43149,4962],[44412,12665],[46718,7932],[49091,11638],[49121,11740],[50860,2133],[52871,912],[53820,1274],[58604,11936],[61859,8953],[63528,1772],[68434,247],[69678,9792],[77018,1667],[77885,8629],[78375,3245],[78675,5220],[83419,7803],[90595,364],[92387,11365],[92950,3874],[93107,10107],[96757,4545],[97132,2086],[97396,2599],[97863,1069],[99054,7292],[103463,1123],[104145,3686],[104483,12350],[104791,12722],[107312,11217],[108802,5178],[109840,8531],[114710,10389],[119668,5822],[120121,516],[122282,2785],[127595,10074],[134381,2618],[134734,1665],[137347,1499],[141344,5213],[142152,661],[143385,420],[144834,219],[146652,2639],[149140,5651],[149924,1679],[150303,6808],[150743,4619],[154742,2765],[155230,12362],[157666,6141],[158996,9901],[161093,8988],[165601,781],[167415,8869],[170202,7040],[175323,4912],[177359,8250],[178808,3694],[179295,2475],[183530,10839],[185232,8571],[187442,9545],[190501,6108],[190985,637],[193885,9949],[195471,12715],[195767,7921],[197686,10289],[202230,12220],[204101,7239],[205759,8642],[206332,9280],[206554,8483],[207947,1540],[208106,1340],[209990,11174],[213039,8603],[213782,355],[214210,959],[215267,636],[216624,1036],[217000,178],[218286,5124],[221482,12253],[223957,4881],[227344,3166],[229475,1100],[231164,1379],[232210,2580],[234339,9887],[234694,8325],[238384,12588],[240634,4564],[241191,11418],[242062,10188],[242630,9959],[242726,1689],[243833,1063],[243980,6746],[246547,2326],[249829,13069],[251512,459],[251627,6627],[255554,2664],[256776,5631],[260401,5911],[263088,9089],[263825,1250],[263826,10980],[264970,4355],[265792,1969],[265978,7734],[267627,4157],[273990,2767],[277364,6613],[279543,2929],[279816,7070],[280218,12022],[282697,7513],[285846,3298],[286274,11306],[287499,3949],[287692,5883],[287881,8501],[290917,10470],[292332,3703],[296343,2133],[299406,6270],[300017,11993],[301389,4432],[304279,4601],[305225,2282],[307123,6650],[309543,7871],[310326,3669],[310824,3922],[311066,4439],[311993,11312],[312326,11574],[312894,2394],[313023,5724],[313353,960],[313477,9137],[315161,11205],[317782,3102],[318307,7054],[318491,5942],[319419,4770],[323960,3521],[331039,3570],[331762,1740],[331964,9631],[332020,4915],[332620,800],[335834,1483],[336805,2510],[337778,8989],[338636,8002],[339604,2881],[339636,11218],[340497,10976],[341090,9362],[342562,4803],[354379,11948],[354925,1355],[358209,7345],[358604,6831],[360467,323],[365523,4217],[367017,8802],[368697,7739],[370028,1403],[371460,6792],[373578,10827],[374204,8569],[375271,9284],[376720,6773],[377529,11235],[378321,8833],[378622,914],[385276,3641],[385945,2234],[389136,512],[391500,7031],[392511,12994],[394864,12078],[395807,12367],[396532,7200],[400162,8143],[403938,7575],[406046,9093],[408755,11243],[408914,12238],[411240,635],[412232,1039],[417221,6391],[417671,2221],[417727,10958],[422950,4314],[424657,12102],[426489,6188],[428173,9031],[429025,12716],[429694,2321],[430055,8865],[437200,4491],[437817,6428],[438919,3396],[444143,8979],[447631,7937],[447697,7300],[448650,11963],[450198,5548],[450622,5541],[457148,543],[458865,6851],[460062,10655],[462516,4611],[463774,5713],[467596,1574],[471829,4894],[472500,1934],[473426,10200],[476165,11311],[483919,11579],[484102,2385],[485152,6111],[487598,10804],[490113,5012],[490169,9005],[494043,1789],[495733,12279],[496905,3245],[497886,10035],[498590,10279],[499278,4339],[500625,12704],[501017,1584],[501479,1263],[501838,1343],[502086,4642],[503544,12714],[506221,11094],[508965,12093],[510874,9058],[511033,3392],[513615,7211],[515011,11560],[515426,8553],[515684,9715],[516580,11556],[518603,5716],[522027,1385],[523432,6231],[524126,6122],[531458,9413],[532124,1404],[535931,9821],[536453,9130],[537110,2060],[542836,5489],[543051,4148],[544564,1400],[545535,11612],[545935,2689],[546919,7527],[551480,3183],[554308,3399],[554468,4466],[556092,9052],[556220,11011],[557443,12933],[560084,8267],[563663,12772],[564484,12648],[570584,2380],[571684,6061],[577138,10652],[578084,8282],[580163,10529],[580984,11882],[582636,7487],[585542,285],[586493,7594],[586910,10067],[587795,7994],[590007,8951],[590021,613],[591457,8482],[591750,12122],[593398,8832],[594869,2323],[597160,11251],[606655,12228],[611147,12955],[611924,9522],[612204,7185],[616732,4388],[619538,2363],[625352,450],[626609,3472],[628652,12415],[630244,1013],[630423,12598],[632501,7253],[640033,10438],[642183,5335],[642442,7050],[642814,530],[643203,3560],[644952,5686],[646184,12603],[646389,3607],[648323,5302],[650953,8820],[653947,4678],[658602,9713],[664420,3460],[664656,1092],[666025,1056],[666507,2991],[666545,9175],[667289,10253],[668042,159],[672131,3640],[673343,1234],[674909,1604],[678014,12651],[682103,3285],[688013,10823],[690186,9586],[691066,10423],[692365,1812],[694483,292],[699083,7741],[705685,4033],[707986,5130],[708626,12698],[717521,9827],[718257,3517],[720620,10985],[721833,11876],[722086,7253],[723699,1874],[726004,5935],[730533,12504],[732398,994],[734579,10083],[736017,874],[737683,2380],[737725,677],[739163,10385],[742796,8129],[743626,7814],[745021,12154],[745928,9911],[749574,8394],[750667,8551],[755571,11772],[761138,2106],[765051,11876],[766742,1269],[769609,10824],[770396,4004],[771890,6415],[772605,9847],[772958,5665],[773012,11185],[773072,10564],[773170,7210],[781707,8510],[783227,1760],[784249,8394],[789796,6159],[790599,2985],[791762,10739],[792041,3363],[792069,4674],[792089,406],[794034,11461],[795491,3810],[805486,9496],[806643,10803],[807497,722],[811225,7932],[811392,1068],[817781,5428],[819888,6490],[821397,5013],[822525,4813],[824040,3581],[825978,5239],[827362,10554],[834522,1677],[836097,10811],[836960,8896],[838529,7554],[840429,9273],[843792,11766],[851041,1230],[857158,11880],[861142,7743],[864571,1294],[866166,7471],[867857,9261],[869621,5532],[874888,4075],[876175,5965],[876219,6060],[877819,12403],[881769,4149],[882530,8988],[882854,12954],[883245,3793],[884693,10460],[885473,3597],[885730,2750],[888465,9341],[890357,4182],[891767,1439],[892416,7630],[894908,4751],[896880,583],[898473,11397],[900437,4329],[903295,6927],[904117,9055],[904919,9261],[907165,11617],[907657,11228],[909366,2086],[909552,11491],[912940,7386],[919143,11330],[919609,11524],[920458,6042],[920746,4040],[921223,8996],[925724,4213],[927399,10746],[929203,8246],[935536,4843],[936365,8932],[942057,13087],[942272,12452],[944872,3058],[950323,3683],[957180,6996],[963710,11647],[964064,8838],[965959,5673],[966196,13074],[967799,4036],[969709,2755],[970565,5034],[974941,3759],[976844,8488],[976941,4586],[978969,6980],[979954,151],[980096,8618],[980371,2710],[981497,8813],[981542,9121],[982200,710],[983555,7639],[987730,5565],[987935,11085],[992762,1854],[992852,1033],[993013,12088],[993092,9960],[995433,874],[997243,11068]])
print Solution().minRefuelStops(1,1,[])
print Solution().minRefuelStops(100,1,[[10,100]])
print Solution().minRefuelStops(100,10,[[10,60],[20,30],[30,30],[70,40]])
print Solution().minRefuelStops(100,1,[[ 1 , 97 ] , [ 2 , 96 ] , [ 3 , 95 ] , [ 4 , 94 ] , [ 5 , 93 ] , [ 6 , 92 ] , [ 7 , 91 ] , [ 8 , 90 ] , [ 9 , 89 ] , [ 10 , 88 ] , [ 11 , 87 ] , [ 12 , 86 ] , [ 13 , 85 ] , [ 14 , 84 ] , [ 15 , 83 ] , [ 16 , 82 ] , [ 17 , 81 ] , [ 18 , 80 ] , [ 19 , 79 ] , [ 20 , 78 ] , [ 21 , 77 ] , [ 22 , 76 ] , [ 23 , 75 ] , [ 24 , 74 ] , [ 25 , 73 ] , [ 26 , 72 ] , [ 27 , 71 ] , [ 28 , 70 ] , [ 29 , 69 ] , [ 30 , 68 ] , [ 31 , 67 ] , [ 32 , 66 ] , [ 33 , 65 ] , [ 34 , 64 ] , [ 35 , 63 ] , [ 36 , 62 ] , [ 37 , 61 ] , [ 38 , 60 ] , [ 39 , 59 ] , [ 40 , 58 ] , [ 41 , 57 ] , [ 42 , 56 ] , [ 43 , 55 ] , [ 44 , 54 ] , [ 45 , 53 ] , [ 46 , 52 ] , [ 47 , 51 ] , [ 48 , 50 ] , [ 49 , 49 ] , [ 50 , 48 ] , [ 51 , 47 ] , [ 52 , 46 ] , [ 53 , 45 ] , [ 54 , 44 ] , [ 55 , 43 ] , [ 56 , 42 ] , [ 57 , 41 ] , [ 58 , 40 ] , [ 59 , 39 ] , [ 60 , 38 ] , [ 61 , 37 ] , [ 62 , 36 ] , [ 63 , 35 ] , [ 64 , 34 ] , [ 65 , 33 ] , [ 66 , 32 ] , [ 67 , 31 ] , [ 68 , 30 ] , [ 69 , 29 ] , [ 70 , 28 ] , [ 71 , 27 ] , [ 72 , 26 ] , [ 73 , 25 ] , [ 74 , 24 ] , [ 75 , 23 ] , [ 76 , 22 ] , [ 77 , 21 ] , [ 78 , 20 ] , [ 79 , 19 ] , [ 80 , 18 ] , [ 81 , 17 ] , [ 82 , 16 ] , [ 83 , 15 ] , [ 84 , 14 ] , [ 85 , 13 ] , [ 86 , 12 ] , [ 87 , 11 ] , [ 88 , 10 ] , [ 89 , 9 ] , [ 90 , 8 ] , [ 91 , 7 ] , [ 92 , 6 ] , [ 93 , 5 ] , [ 94 , 4 ] , [ 95 , 3 ] , [ 96 , 2 ] , [ 97 , 1 ] ])
print Solution().minRefuelStops(100,1,[[ 1 , 1 ] , [ 2 , 1 ] , [ 3 , 1 ] , [ 4 , 1 ] , [ 5 , 1 ] , [ 6 , 1 ] , [ 7 , 1 ] , [ 8 , 1 ] , [ 9 , 1 ] , [ 10 , 1 ] , [ 11 , 1 ] , [ 12 , 1 ] , [ 13 , 1 ] , [ 14 , 1 ] , [ 15 , 1 ] , [ 16 , 1 ] , [ 17 , 1 ] , [ 18 , 1 ] , [ 19 , 1 ] , [ 20 , 1 ] , [ 21 , 1 ] , [ 22 , 1 ] , [ 23 , 1 ] , [ 24 , 1 ] , [ 25 , 1 ] , [ 26 , 1 ] , [ 27 , 1 ] , [ 28 , 1 ] , [ 29 , 1 ] , [ 30 , 1 ] , [ 31 , 1 ] , [ 32 , 1 ] , [ 33 , 1 ] , [ 34 , 1 ] , [ 35 , 1 ] , [ 36 , 1 ] , [ 37 , 1 ] , [ 38 , 1 ] , [ 39 , 1 ] , [ 40 , 1 ] , [ 41 , 1 ] , [ 42 , 1 ] , [ 43 , 1 ] , [ 44 , 1 ] , [ 45 , 1 ] , [ 46 , 1 ] , [ 47 , 1 ] , [ 48 , 1 ] , [ 49 , 1 ] , [ 50 , 1 ] , [ 51 , 1 ] , [ 52 , 1 ] , [ 53 , 1 ] , [ 54 , 1 ] , [ 55 , 1 ] , [ 56 , 1 ] , [ 57 , 1 ] , [ 58 , 1 ] , [ 59 , 1 ] , [ 60 , 1 ] , [ 61 , 1 ] , [ 62 , 1 ] , [ 63 , 1 ] , [ 64 , 1 ] , [ 65 , 1 ] , [ 66 , 1 ] , [ 67 , 1 ] , [ 68 , 1 ] , [ 69 , 1 ] , [ 70 , 1 ] , [ 71 , 1 ] , [ 72 , 1 ] , [ 73 , 1 ] , [ 74 , 1 ] , [ 75 , 1 ] , [ 76 , 1 ] , [ 77 , 1 ] , [ 78 , 1 ] , [ 79 , 1 ] , [ 80 , 1 ] , [ 81 , 1 ] , [ 82 , 1 ] , [ 83 , 1 ] , [ 84 , 1 ] , [ 85 , 1 ] , [ 86 , 1 ] , [ 87 , 1 ] , [ 88 , 1 ] , [ 89 , 1 ] , [ 90 , 1 ] , [ 91 , 1 ] , [ 92 , 1 ] , [ 93 , 1 ] , [ 94 , 1 ] , [ 95 , 1 ] , [ 96 , 1 ] , [ 97 , 1 ],[98,1]])
print Solution().minRefuelStops(100,1,[[ 1 , 1 ] , [ 2 , 1 ] , [ 3 , 1 ] , [ 4 , 1 ] , [ 5 , 1 ] , [ 6 , 1 ] , [ 7 , 1 ] , [ 8 , 1 ] , [ 9 , 1 ] , [ 10 , 1 ] , [ 11 , 1 ] , [ 12 , 1 ] , [ 13 , 1 ] , [ 14 , 1 ] , [ 15 , 1 ] , [ 16 , 1 ] , [ 17 , 1 ] , [ 18 , 1 ] , [ 19 , 1 ] , [ 20 , 1 ] , [ 21 , 1 ] , [ 22 , 1 ] , [ 23 , 1 ] , [ 24 , 1 ] , [ 25 , 1 ] , [ 26 , 1 ] , [ 27 , 1 ] , [ 28 , 1 ] , [ 29 , 1 ] , [ 30 , 1 ] , [ 31 , 1 ] , [ 32 , 1 ] , [ 33 , 1 ] , [ 34 , 1 ] , [ 35 , 1 ] , [ 36 , 1 ] , [ 37 , 1 ] , [ 38 , 1 ] , [ 39 , 1 ] , [ 40 , 1 ] , [ 41 , 1 ] , [ 42 , 1 ] , [ 43 , 1 ] , [ 44 , 1 ] , [ 45 , 1 ] , [ 46 , 1 ] , [ 47 , 1 ] , [ 48 , 1 ] , [ 49 , 1 ] , [ 50 , 1 ] , [ 51 , 1 ] , [ 52 , 1 ] , [ 53 , 1 ] , [ 54 , 1 ] , [ 55 , 1 ] , [ 56 , 1 ] , [ 57 , 1 ] , [ 58 , 1 ] , [ 59 , 1 ] , [ 60 , 1 ] , [ 61 , 1 ] , [ 62 , 1 ] , [ 63 , 1 ] , [ 64 , 1 ] , [ 65 , 1 ] , [ 66 , 1 ] , [ 67 , 1 ] , [ 68 , 1 ] , [ 69 , 1 ] , [ 70 , 1 ] , [ 71 , 1 ] , [ 72 , 1 ] , [ 73 , 1 ] , [ 74 , 1 ] , [ 75 , 1 ] , [ 76 , 1 ] , [ 77 , 1 ] , [ 78 , 1 ] , [ 79 , 1 ] , [ 80 , 1 ] , [ 81 , 1 ] , [ 82 , 1 ] , [ 83 , 1 ] , [ 84 , 1 ] , [ 85 , 1 ] , [ 86 , 1 ] , [ 87 , 1 ] , [ 88 , 1 ] , [ 89 , 1 ] , [ 90 , 1 ] , [ 91 , 1 ] , [ 92 , 1 ] , [ 93 , 1 ] , [ 94 , 1 ] , [ 95 , 1 ] , [ 96 , 1 ] , [ 97 , 1 ],[98,1],[99,1]])
"""
