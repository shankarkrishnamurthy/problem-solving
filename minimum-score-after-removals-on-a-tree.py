import sys
from collections import *
sys.setrecursionlimit(10000)
class Solution:
    def minimumScore(self, nums, el):
        n, xor, par, g, res = len(nums), [-1]*len(nums), [set()]*len(nums), defaultdict(list), float("inf")
        for (i,j) in el:
            g.setdefault(i, []).append(j), g.setdefault(j, []).append(i)
        def dfs(i, v, pl):
            v.add(i)
            pl.append(i)
            res, par[i] = 0, set(pl)
            for e in g[i]:
                if e in v: continue
                res ^= dfs(e, v, pl)
            xor[i] = res^nums[i]
            pl.pop()
            return xor[i]
        dfs(0, set(), []) # tree rooted in 0
        #print('parent', par), print('xor', xor)
        for i in range(n-2):
            for j in range(i+1,n-1):
                n1,n2,n3,n4 = el[i][0], el[i][1], el[j][0], el[j][1]
                if n2 not in par[n1]: n1,n2 = n2, n1
                if n4 not in par[n3]: n3,n4 = n4, n3
                if n3 in par[n2]: g1, g2 = xor[n1], xor[0] ^ xor[n3] # n3 part of n2 ancestry
                elif n1 in par[n4]: g1, g2 = xor[n3], xor[0] ^ xor[n1] # n1 part of n4 ancestry
                else: g1, g2 = xor[n1], xor[n3]
                g3 = xor[0] ^ g1 ^ g2
                res = min(res, max(g1,g2,g3) - min(g1,g2,g3))
                #print((i,j), (n1,n2,n3,n4), here, 'g1',g1,'g2',g2,'g3',g3)
        return res

print(Solution().minimumScore([43046785,86567150,40380918,48847771,80230513,2878698,91736791,7379197,27726778,38851132,93865870,32212620,24796998,58962723,65923918,69780520,55645783,21602257,95902283,19540946,2536418,37492097,73216185,84465359,54504592,48587764,87737612,35277838,91062183,46757316,21795018,95109732,38515480,22045719,29723643,45796891,28770419,77441377,55931249,95069323,36983303,62211023,36663777,4873668,37263977,57529546,38417416,95308107,51320586,65752537,35761591,46154668,88346818,89474237,61771245,88439756,45312210,23130801,83088813,23232456,74474038,59581199,13362481,80975582,85905905,36428261,73730912,90945207,81795559,6565367,3789961,57182856,98488167,1933307,66094213,87460760,89807723,22925033,88066887,77142791,33998687,83078212,66422591,83931921,73196727,75536923,30827111,93347433,83890888,28305721,19301480,61743549,39823055,93172573,13181368,81454881,94100214,7009533,50943117,14811921,66916709,88438071,18014792,825827,65488338,26653585,32201893,63799676,14410032,78560616,97579512,60390611,81609336,66994814,41347877,49161297,64957471,55747270,40990049,82302250,52107066,81060515,22581796,80249074,44715858,93838138,35501778,85133205,61298584,25527382,57368317,76494937,96818225,54344160,27120255,40820612,16923328,21131318,52171993,48887849,73298100,99802062,80661804,42038610,81926929,79793381,79208084,38571720,37402759,99997889,84925081,58491066,89767694,4103071,97374184,21113693,7903506,74236659,33175672,10590934,12372731,49588817,9078295,79475489,92093982,56485166,48016156,38627007,64881198,66807902,63412132,39811764,88875355,36487324,94202088,78992339,25067516,83806511,64230816,42630526,46121405,98051817,33557731,40773859,9801487,33757830,38232904,26676871,26438359,92246482,8754095,41628481,77110175,79324869,36819424,56022368,70849875,21541575,69495596,57395356,15991869,78094608,11126340,38189097,68605368,89220111,21096862,25983275,96950048,76017360,92765808,59495062,71401547,99392013,5382683,50882664,94901810,23428796,8210667,71461741,20775867,78070614,66051540,36729825,93671098,72991282,46206932,22707041,67852877,26565142,87149218,25117265,13248236,59724889,17377869,35747966,11862548,3048956,81530467,35185046,80228190,31059350,99889990,42486546,751845,76292992,9694837,5864708,69407816,53909745,2391422,91535702,59080479,14792556,59030218,3767358,21651962,40168238,49743941,31697262,40819157,44970831,78318893,82701723,96515540,45485637,5044117,11166894,97643116,14325269,72709157,11925296,92008505,14863178,4796785,47593166,85325271,22362348,29956287,90207140,65629252,79444231,16950823,7961324,38742341,63034744,85021475,23927345,18130303,27679342,9439202,88948285,92222480,75183152,78676819,23513263,40596735,85088152,61263974,5370201,90646200,20623107,76693122,50494066,25240883,32305670,83539729,74817121,64638406,75963868,88251627,96176118,66320524,68549569,34806521,7006783,67930538,37917802,64523799,47349642,86326132,3870871,12363177,4396312,46701728,57886695,50380382,55425671,99251896,79752340,78408332,19170909,49458972,32459462,88892683,39369762,12492970,3676782,7568221,59390819,45093075,58991713,30417789,66153692,51817111,56637346,249954,64685303,89674844,19070245,78579940,53876367,969473,95671969,62142662,16839558,55717351,21085934,30210696,53612000,4680192,18692550,75505388,83011306,99914306,94608193,64089882,72117125,86527358,24474855,48762230,38370589,26008904,34835072,34036776,10372994,10534174,11259226,44303792,22086086,53470172,93648633,56227838,42638412,33527,56743892,41390501,29466246,59294543,18242775,16318078,39949781,50643969,99666097,5475839,62061794,37380970,74322958,47219720,47023170,55272338,81568617,97124338,15030451,10334754,27198064,79300880,60131248,93800820,74616981,12475853,67943880,68928406,67022563,29432835,83556751,29989111,55582187,82569448,59362086,43324312,66778251,86701043,42505862,48652291,38424419,28473065,62706490,2770900,69155877,22819748,9475803,5006531,51168191,5975841,1528421,25266090,73987522,1770627,21199128,32575488,29993388,30321130,27022079,65388504,15411119,17644893,30635519,98325744,31416021,25563140,12323936,245267,11498738,1810271,98502340,99086864,19702603,18835400,24935491,19660551,15478685,18266375,97968196,63545537,98095843,83669868,15834218,38354833,73926889,23792625,20265427,51161498,86424687,90984443,50506157,64439272,79750112,93489277,54781694,40785373,48288110,49613960,44283205,15798011,38300702,1728671,33385847,24425717,60878478,41882623,16639915,46042983,62041440,35797702,78951391,54381612,2275604,45074462,21877226,36670650,16793485,80292676,14038007,49920098,39756089,56849783,87273078,21231418,2699929,65186358,22980381,16215166,72316130,171112,39213385,86417901,82347842,32362013,7550879,34466,45827869,31147872,96364480,52144073,57271992,1337134,93012639,30622020,83682440,73576921,51284387,65486141,18785917,30197213,42176107,83944707,29224651,58804057,97277193,35995751,31284563,82351148,61087934,98941907,44136836,90076690,27433656,3862758,28388819,71683211,14549000,8919723,4379675,13425292,52880616,37987889,99045790,28987670,91572633,36261743,40258155,49057129,30177688,61521077,92886222,50953895,37422218,26307320,33287368,24393869,6916370,43811559,25612573,72845870,50537142,53771260,96217586,53731872,20768625,98156333,82074407,17347287,44527353,33648195,28304045,60680640,76311671,29745516,10339471,67651031,77473692,1313749,92652514,96319212,63859058,2000884,19905359,29790117,51595146,47490253,5198046,86975488,98599570,40374107,96937210,29781120,94653897,81572124,18161485,81498587,29076107,82464119,56905561,35835678,28099642,85139901,13103105,94014286,32456012,73624083,10610910,76640870,54093238,70127795,91616179,19872324,16622899,27084339,75650110,26625623,57216978,16765281,78818892,59126209,43903230,18685891,36994384,38453869,16682253,81218813,60896103,4153542,43812506,87575580,77681198,71337838,49095237,63120698,66815876,51791747,31758578,80686544,92302727,58098904,20431312,74664846,38931028,33836176,35561113,45670107,31090575,14788101,69369439,69190312,11360641,16232618,84107290,95224211,28318682,41035131,74982422,26716480,19685719,16820630,54183281,4718162,87479805,39990379,40130474,80636840,20104265,80233137,55139076,9215571,23478601,48209324,75827961,47282716,39994991,36368302,74120382,14441261,67563853,65596565,7323354,89104947,5483700,65850608,43344793,64862373,16418194,76933885,4288239,43494187,93162772,21764126,52826290,91197667,42888894,39830820,53826836,25740284,15445571,69931528,69661101,70124777,41268777,14303577,76687433,84102241,83077740,97338489,58442144,37852840,3799145,13590094,34950150,94148784,94320783,61625877,48926460,88914355,14603508,11434221,52598391,28060758,65653406,69756828,95074216,57833696,39048284,24908234,58395743,6461714,87267151,37828701,13698973,46485101,94118021,23988448,62483222,72774125,23564531,3501763,92364343,52851576,80238676,28301972,25031955,13306478,7231829,36035486,42777413,18407604,38989131,68624095,54415374,36112619,41188243,84596061,62319000,40465703,96115345,46159606,39310123,58876903,80839558,70381284,7603068,23911159,21052129,89160045,18095542,98390792,93038393,58739488,6394082,1106347,29370782,84196653,18360890,75172868,11089659,73183310,74118413,10881703,81647590,2845624,64077053,74827371,88183439,5452356,80418269,92101626,89031791,34542203,24195456,48611723,41642418,72940398,87040054,1475920,26511216,40124445,34104364,7216025,69914096,63977942,50055701,19750636,24503840,89009587,70745798,61564848,70480143,45097627,61246567,5382864,33905068,61496382,10686028,23097807,21021708,76359857,69799538,34279016,11178628,80701324,38215134,76173529,70999251,64894558,49231696,1170852,88422822,26294022,41747180,74781196,81587785,92035146,43305179,74111010,89211819,16012590,32919574,60630557,86786282,4451387,80719759,36379776,40706911,20563088,31890940,55954892,11042033,78992851,71735981,41278094,72646591,87570266,30649185,64749768,42355583,9579959,42367019,62409626,99691738,96312333,76150369,9508653,49630745,30707898,39257443,18123931,84698119,81368592,98410821,79699725,3106817,62129472,23079792,49657850,5873843,90508665,5855985,83801797,89052590,29997247,65032417,76914904,83794688,33251898,58205403,74950794,22011275,77391252,75889121,39003202,74945925,49165955,78087259,89294847,45076041,43015240,50343143,67847208,69257559,67056951,13832893,36115901,40669140,69800129,3237452,11976722,46490250,91475634,26540997,29547675,56538166,66510602,29689857,52324185,46814671,8635150,72976697,5516351,94466063,52063176,66202008,7100218,7461963,27731181,16118656,69052080,87544949,89606676,69945579,82057446,35123442,51545486,59701701,50270426,76951532,88866850,49074721,63222851,89760743,54863896,52149356,72338308,2569523,97737693,13716990,92258491,63796447,36374649,45597868,40921947,46367423,78497628,4338826,89376377,51146514,13876312,69622419,20176957,17588193,1130009,96232590,31563449,6204186,5517838,43932526,4954269,20387822,21978652,74028198,18562588,93901865,84208538,31936461,38053498,61538517,57626825,81120218,26646800,78394275,56246938,4310949], [[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,14],[14,15],[15,16],[16,17],[17,18],[18,19],[19,20],[20,21],[21,22],[22,23],[23,24],[24,25],[25,26],[26,27],[27,28],[28,29],[29,30],[30,31],[31,32],[32,33],[33,34],[34,35],[35,36],[36,37],[37,38],[38,39],[39,40],[40,41],[41,42],[42,43],[43,44],[44,45],[45,46],[46,47],[47,48],[48,49],[49,50],[50,51],[51,52],[52,53],[53,54],[54,55],[55,56],[56,57],[57,58],[58,59],[59,60],[60,61],[61,62],[62,63],[63,64],[64,65],[65,66],[66,67],[67,68],[68,69],[69,70],[70,71],[71,72],[72,73],[73,74],[74,75],[75,76],[76,77],[77,78],[78,79],[79,80],[80,81],[81,82],[82,83],[83,84],[84,85],[85,86],[86,87],[87,88],[88,89],[89,90],[90,91],[91,92],[92,93],[93,94],[94,95],[95,96],[96,97],[97,98],[98,99],[99,100],[100,101],[101,102],[102,103],[103,104],[104,105],[105,106],[106,107],[107,108],[108,109],[109,110],[110,111],[111,112],[112,113],[113,114],[114,115],[115,116],[116,117],[117,118],[118,119],[119,120],[120,121],[121,122],[122,123],[123,124],[124,125],[125,126],[126,127],[127,128],[128,129],[129,130],[130,131],[131,132],[132,133],[133,134],[134,135],[135,136],[136,137],[137,138],[138,139],[139,140],[140,141],[141,142],[142,143],[143,144],[144,145],[145,146],[146,147],[147,148],[148,149],[149,150],[150,151],[151,152],[152,153],[153,154],[154,155],[155,156],[156,157],[157,158],[158,159],[159,160],[160,161],[161,162],[162,163],[163,164],[164,165],[165,166],[166,167],[167,168],[168,169],[169,170],[170,171],[171,172],[172,173],[173,174],[174,175],[175,176],[176,177],[177,178],[178,179],[179,180],[180,181],[181,182],[182,183],[183,184],[184,185],[185,186],[186,187],[187,188],[188,189],[189,190],[190,191],[191,192],[192,193],[193,194],[194,195],[195,196],[196,197],[197,198],[198,199],[199,200],[200,201],[201,202],[202,203],[203,204],[204,205],[205,206],[206,207],[207,208],[208,209],[209,210],[210,211],[211,212],[212,213],[213,214],[214,215],[215,216],[216,217],[217,218],[218,219],[219,220],[220,221],[221,222],[222,223],[223,224],[224,225],[225,226],[226,227],[227,228],[228,229],[229,230],[230,231],[231,232],[232,233],[233,234],[234,235],[235,236],[236,237],[237,238],[238,239],[239,240],[240,241],[241,242],[242,243],[243,244],[244,245],[245,246],[246,247],[247,248],[248,249],[249,250],[250,251],[251,252],[252,253],[253,254],[254,255],[255,256],[256,257],[257,258],[258,259],[259,260],[260,261],[261,262],[262,263],[263,264],[264,265],[265,266],[266,267],[267,268],[268,269],[269,270],[270,271],[271,272],[272,273],[273,274],[274,275],[275,276],[276,277],[277,278],[278,279],[279,280],[280,281],[281,282],[282,283],[283,284],[284,285],[285,286],[286,287],[287,288],[288,289],[289,290],[290,291],[291,292],[292,293],[293,294],[294,295],[295,296],[296,297],[297,298],[298,299],[299,300],[300,301],[301,302],[302,303],[303,304],[304,305],[305,306],[306,307],[307,308],[308,309],[309,310],[310,311],[311,312],[312,313],[313,314],[314,315],[315,316],[316,317],[317,318],[318,319],[319,320],[320,321],[321,322],[322,323],[323,324],[324,325],[325,326],[326,327],[327,328],[328,329],[329,330],[330,331],[331,332],[332,333],[333,334],[334,335],[335,336],[336,337],[337,338],[338,339],[339,340],[340,341],[341,342],[342,343],[343,344],[344,345],[345,346],[346,347],[347,348],[348,349],[349,350],[350,351],[351,352],[352,353],[353,354],[354,355],[355,356],[356,357],[357,358],[358,359],[359,360],[360,361],[361,362],[362,363],[363,364],[364,365],[365,366],[366,367],[367,368],[368,369],[369,370],[370,371],[371,372],[372,373],[373,374],[374,375],[375,376],[376,377],[377,378],[378,379],[379,380],[380,381],[381,382],[382,383],[383,384],[384,385],[385,386],[386,387],[387,388],[388,389],[389,390],[390,391],[391,392],[392,393],[393,394],[394,395],[395,396],[396,397],[397,398],[398,399],[399,400],[400,401],[401,402],[402,403],[403,404],[404,405],[405,406],[406,407],[407,408],[408,409],[409,410],[410,411],[411,412],[412,413],[413,414],[414,415],[415,416],[416,417],[417,418],[418,419],[419,420],[420,421],[421,422],[422,423],[423,424],[424,425],[425,426],[426,427],[427,428],[428,429],[429,430],[430,431],[431,432],[432,433],[433,434],[434,435],[435,436],[436,437],[437,438],[438,439],[439,440],[440,441],[441,442],[442,443],[443,444],[444,445],[445,446],[446,447],[447,448],[448,449],[449,450],[450,451],[451,452],[452,453],[453,454],[454,455],[455,456],[456,457],[457,458],[458,459],[459,460],[460,461],[461,462],[462,463],[463,464],[464,465],[465,466],[466,467],[467,468],[468,469],[469,470],[470,471],[471,472],[472,473],[473,474],[474,475],[475,476],[476,477],[477,478],[478,479],[479,480],[480,481],[481,482],[482,483],[483,484],[484,485],[485,486],[486,487],[487,488],[488,489],[489,490],[490,491],[491,492],[492,493],[493,494],[494,495],[495,496],[496,497],[497,498],[498,499],[499,500],[500,501],[501,502],[502,503],[503,504],[504,505],[505,506],[506,507],[507,508],[508,509],[509,510],[510,511],[511,512],[512,513],[513,514],[514,515],[515,516],[516,517],[517,518],[518,519],[519,520],[520,521],[521,522],[522,523],[523,524],[524,525],[525,526],[526,527],[527,528],[528,529],[529,530],[530,531],[531,532],[532,533],[533,534],[534,535],[535,536],[536,537],[537,538],[538,539],[539,540],[540,541],[541,542],[542,543],[543,544],[544,545],[545,546],[546,547],[547,548],[548,549],[549,550],[550,551],[551,552],[552,553],[553,554],[554,555],[555,556],[556,557],[557,558],[558,559],[559,560],[560,561],[561,562],[562,563],[563,564],[564,565],[565,566],[566,567],[567,568],[568,569],[569,570],[570,571],[571,572],[572,573],[573,574],[574,575],[575,576],[576,577],[577,578],[578,579],[579,580],[580,581],[581,582],[582,583],[583,584],[584,585],[585,586],[586,587],[587,588],[588,589],[589,590],[590,591],[591,592],[592,593],[593,594],[594,595],[595,596],[596,597],[597,598],[598,599],[599,600],[600,601],[601,602],[602,603],[603,604],[604,605],[605,606],[606,607],[607,608],[608,609],[609,610],[610,611],[611,612],[612,613],[613,614],[614,615],[615,616],[616,617],[617,618],[618,619],[619,620],[620,621],[621,622],[622,623],[623,624],[624,625],[625,626],[626,627],[627,628],[628,629],[629,630],[630,631],[631,632],[632,633],[633,634],[634,635],[635,636],[636,637],[637,638],[638,639],[639,640],[640,641],[641,642],[642,643],[643,644],[644,645],[645,646],[646,647],[647,648],[648,649],[649,650],[650,651],[651,652],[652,653],[653,654],[654,655],[655,656],[656,657],[657,658],[658,659],[659,660],[660,661],[661,662],[662,663],[663,664],[664,665],[665,666],[666,667],[667,668],[668,669],[669,670],[670,671],[671,672],[672,673],[673,674],[674,675],[675,676],[676,677],[677,678],[678,679],[679,680],[680,681],[681,682],[682,683],[683,684],[684,685],[685,686],[686,687],[687,688],[688,689],[689,690],[690,691],[691,692],[692,693],[693,694],[694,695],[695,696],[696,697],[697,698],[698,699],[699,700],[700,701],[701,702],[702,703],[703,704],[704,705],[705,706],[706,707],[707,708],[708,709],[709,710],[710,711],[711,712],[712,713],[713,714],[714,715],[715,716],[716,717],[717,718],[718,719],[719,720],[720,721],[721,722],[722,723],[723,724],[724,725],[725,726],[726,727],[727,728],[728,729],[729,730],[730,731],[731,732],[732,733],[733,734],[734,735],[735,736],[736,737],[737,738],[738,739],[739,740],[740,741],[741,742],[742,743],[743,744],[744,745],[745,746],[746,747],[747,748],[748,749],[749,750],[750,751],[751,752],[752,753],[753,754],[754,755],[755,756],[756,757],[757,758],[758,759],[759,760],[760,761],[761,762],[762,763],[763,764],[764,765],[765,766],[766,767],[767,768],[768,769],[769,770],[770,771],[771,772],[772,773],[773,774],[774,775],[775,776],[776,777],[777,778],[778,779],[779,780],[780,781],[781,782],[782,783],[783,784],[784,785],[785,786],[786,787],[787,788],[788,789],[789,790],[790,791],[791,792],[792,793],[793,794],[794,795],[795,796],[796,797],[797,798],[798,799],[799,800],[800,801],[801,802],[802,803],[803,804],[804,805],[805,806],[806,807],[807,808],[808,809],[809,810],[810,811],[811,812],[812,813],[813,814],[814,815],[815,816],[816,817],[817,818],[818,819],[819,820],[820,821],[821,822],[822,823],[823,824],[824,825],[825,826],[826,827],[827,828],[828,829],[829,830],[830,831],[831,832],[832,833],[833,834],[834,835],[835,836],[836,837],[837,838],[838,839],[839,840],[840,841],[841,842],[842,843],[843,844],[844,845],[845,846],[846,847],[847,848],[848,849],[849,850],[850,851],[851,852],[852,853],[853,854],[854,855],[855,856],[856,857],[857,858],[858,859],[859,860],[860,861],[861,862],[862,863],[863,864],[864,865],[865,866],[866,867],[867,868],[868,869],[869,870],[870,871],[871,872],[872,873],[873,874],[874,875],[875,876],[876,877],[877,878],[878,879],[879,880],[880,881],[881,882],[882,883],[883,884],[884,885],[885,886],[886,887],[887,888],[888,889],[889,890],[890,891],[891,892],[892,893],[893,894],[894,895],[895,896],[896,897],[897,898],[898,899],[899,900],[900,901],[901,902],[902,903],[903,904],[904,905],[905,906],[906,907],[907,908],[908,909],[909,910],[910,911],[911,912],[912,913],[913,914],[914,915],[915,916],[916,917],[917,918],[918,919],[919,920],[920,921],[921,922],[922,923],[923,924],[924,925],[925,926],[926,927],[927,928],[928,929],[929,930],[930,931],[931,932],[932,933],[933,934],[934,935],[935,936],[936,937],[937,938],[938,939],[939,940],[940,941],[941,942],[942,943],[943,944],[944,945],[945,946],[946,947],[947,948],[948,949],[949,950],[950,951],[951,952],[952,953],[953,954],[954,955],[955,956],[956,957],[957,958],[958,959],[959,960],[960,961],[961,962],[962,963],[963,964],[964,965],[965,966],[966,967],[967,968],[968,969],[969,970],[970,971],[971,972],[972,973],[973,974],[974,975],[975,976],[976,977],[977,978],[978,979],[979,980],[980,981],[981,982],[982,983],[983,984],[984,985],[985,986],[986,987],[987,988],[988,989],[989,990],[990,991],[991,992],[992,993],[993,994],[994,995],[995,996],[996,997],[997,998],[998,999]]))
#[1001,20002,10978,98767,3414,1981,5968,987,2984,56341,891,10389174]
#[[0,11],[0,10],[0,9],[9,8],[9,7],[7,6],[7,5],[7,4],[8,1],[8,2],[8,3]]
